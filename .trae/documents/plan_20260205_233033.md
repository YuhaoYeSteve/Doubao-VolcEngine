要为项目加入联网搜索功能，我建议采用 **Function Calling (工具调用)** 的方式。这允许大模型根据用户的问题自主判断是否需要搜索，并利用搜索结果生成回答。

我们将使用开源免费的 `duckduckgo-search` 库作为搜索引擎。

### 📅 实施计划

#### 1. 依赖管理
- 在 `requirements.txt` 中添加 `duckduckgo-search`。
- **安装新依赖**：这一步是指运行 `pip install` 命令，将 `duckduckgo-search` 这个 Python 库下载并安装到您的开发环境中，这样我们的代码才能使用它来进行网络搜索。

#### 2. 后端改造 (`ark_server.py`)
- **引入搜索库**：集成 `DuckDuckGoSearchRun` 用于执行搜索。
- **定义工具**：创建 `web_search` 的工具描述（Schema），告知模型它具备搜索能力。
- **重构对话流程**：
  1.  **首轮推断**：接收用户请求后，先调用模型（暂不流式），传入 `tools` 定义。
  2.  **判断意图**：
      - 如果模型返回 `tool_calls`（决定搜索）：执行搜索逻辑，将搜索结果追加到消息历史，然后发起**第二轮调用**（开启流式）生成最终回答。
      - 如果模型直接回答：直接将回答返回给前端。
  3.  **流式兼容**：确保无论是直接回答还是搜索后的回答，最终都以 SSE (Server-Sent Events) 格式流式返回给前端。

#### 3. 前端微调 (`chat.html`)
- 前端代码基本无需改动，因为复杂的“搜索-思考-回答”逻辑被封装在后端。
- 用户在提问“今天北京天气如何？”时，会感觉到响应稍慢（正在搜索），然后看到基于最新信息的回答。

### ⚠️ 注意事项
- **延迟**：引入搜索会增加首字生成的延迟（因为需要先请求搜索引擎）。
- **模型能力**：豆包模型（Doubao-pro/lite）通常支持工具调用，我们将利用这一能力。

确认后，我将为您安装依赖并升级代码。